<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="rustdoc">
    <meta name="description" content="API documentation for the Rust `rshark` crate.">
    <meta name="keywords" content="rust, rustlang, rust-lang, rshark">

    <title>rshark - Rust</title>

    <link rel="stylesheet" type="text/css" href="../main.css">

    
    
</head>
<body class="rustdoc">
    <!--[if lte IE 8]>
    <div class="warning">
        This old browser is unsupported and will most likely display funky
        things.
    </div>
    <![endif]-->

    

    <section class="sidebar">
        <a href='../rshark/index.html'><img src='https://raw.githubusercontent.com/musec/rusty-shark/master/artwork/wordmark.png' alt='' width='100'></a>
        <p class='location'></p><script>window.sidebarCurrent = {name: 'rshark', ty: 'mod', relpath: '../'};</script>
    </section>

    <nav class="sub">
        <form class="search-form js-only">
            <div class="search-container">
                <input class="search-input" name="search"
                       autocomplete="off"
                       placeholder="Click or press ‘S’ to search, ‘?’ for more options…"
                       type="search">
            </div>
        </form>
    </nav>

    <section id='main' class="content mod">
<h1 class='fqn'><span class='in-band'>Crate <a class='mod' href=''>rshark</a></span><span class='out-of-band'><span id='render-detail'>
            <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">
                [<span class='inner'>&#x2212;</span>]
            </a>
        </span><a id='src-0' class='srclink' href='../src/rshark/lib.rs.html#1-269' title='goto source code'>[src]</a></span></h1>
<div class='docblock'><p><code>rshark</code>, the Rusty Shark library, is a library for inspecting malicious packets.</p>

<h1 id="background" class='section-header'><a
                           href="#background">Background</a></h1>
<p><a href="https://www.wireshark.org">Wireshark</a> is a very useful tool for network
debugging, but it&#39;s had its
<a href="https://www.wireshark.org/security">fair share of security vulnerabilities</a>.
It&#39;s generally accepted that, to succeed at Capture the Flag, one should fuzz
Wireshark for awhile before the competition to find a few new vulnerabilities
(don&#39;t worry, they&#39;re there, you&#39;ll find some) and use those offensively to
blind one&#39;s opponents.
This speaks to both the indispensability of packet capture/dissection tools
and the fundamental difficulty of ``just making Wireshark secure&#39;&#39;.
Wireshark has a <em>lot</em> of dissectors, which are written using a
<a href="https://www.wireshark.org/docs/wsdg_html_chunked/ChDissectAdd.html">complex C API</a>
(although some are now written in Lua).</p>

<p><code>rshark</code> uses the type safety of Rust to enable the dissection of
malicious packets without worry of buffer overflows or other common memory errors.
Rusty Shark dissectors can make mistakes, but those logical errors should only
affect the interpretation of the <em>current</em> data, rather than <em>all</em> data.
That is to say, Rusty Shark is compartmentalized to minimize the damage that
can be done by a successful adversary. The submarine metaphors write themselves.</p>

<h1 id="usage" class='section-header'><a
                           href="#usage">Usage</a></h1>
<p><em>note: for help on the <code>rshark</code> command-line client,
run <code>man rshark</code> or <code>rshark --help</code>.</em></p>

<p>The <code>rshark</code> library provides packet dissection functions such as
<code>rshark::ethernet::dissect()</code>. Every such dissection function, which should
conform to the <code>rshark::Dissector</code> function type, takes as input a slice of bytes
and returns an <code>rshark::Result</code> (which defaults to
<code>Result&lt;rshark::Val, rshark::Error&gt;</code>).
Usage is pretty simple:</p>
<pre class='rust rust-example-rendered'>
<span class='kw'>let</span> <span class='ident'>data</span> <span class='op'>=</span> <span class='macro'>vec</span><span class='macro'>!</span>[];

<span class='kw'>match</span> <span class='ident'>rshark</span>::<span class='ident'>ethernet</span>::<span class='ident'>dissect</span>(<span class='kw-2'>&amp;</span><span class='ident'>data</span>) {
    <span class='prelude-val'>Err</span>(<span class='ident'>e</span>) <span class='op'>=&gt;</span> <span class='macro'>println</span><span class='macro'>!</span>[<span class='string'>&quot;Error: {}&quot;</span>, <span class='ident'>e</span>],
    <span class='prelude-val'>Ok</span>(<span class='ident'>val</span>) <span class='op'>=&gt;</span> <span class='macro'>print</span><span class='macro'>!</span>[<span class='string'>&quot;{}&quot;</span>, <span class='ident'>val</span>.<span class='ident'>pretty_print</span>(<span class='number'>0</span>)],
}</pre>

<p>A <code>Val</code> can represent an arbitrary tree of structured data
(useful in graphical displays) and can be pretty-printed with indentation for
sub-objects.</p>
</div><h2 id='modules' class='section-header'><a href="#modules">Modules</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='mod' href='ethernet/index.html'
                               title='rshark::ethernet'>ethernet</a></td>
                        <td class='docblock short'>
                             <p>Dissection of Ethernet (IEEE 802.3) frames.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='mod' href='ip/index.html'
                               title='rshark::ip'>ip</a></td>
                        <td class='docblock short'>
                             <p>Dissection of Internet Protocol (IP) packets.</p>

                        </td>
                    </tr>
                </table><h2 id='enums' class='section-header'><a href="#enums">Enums</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='enum' href='enum.Endianness.html'
                               title='rshark::Endianness'>Endianness</a></td>
                        <td class='docblock short'>
                             <p>Little- or big-endian integer representations.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='enum' href='enum.Error.html'
                               title='rshark::Error'>Error</a></td>
                        <td class='docblock short'>
                             <p>An error related to packet dissection (underflow, bad value, etc.).</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='enum' href='enum.Val.html'
                               title='rshark::Val'>Val</a></td>
                        <td class='docblock short'>
                             <p>A value parsed from a packet.</p>

                        </td>
                    </tr>
                </table><h2 id='functions' class='section-header'><a href="#functions">Functions</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='fn' href='fn.raw.html'
                               title='rshark::raw'>raw</a></td>
                        <td class='docblock short'>
                             <p>Dissector of last resort: store raw bytes without interpretation.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='fn' href='fn.signed.html'
                               title='rshark::signed'>signed</a></td>
                        <td class='docblock short'>
                             <p>Parse a signed integer of a given endianness from a byte buffer.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='fn' href='fn.unsigned.html'
                               title='rshark::unsigned'>unsigned</a></td>
                        <td class='docblock short'>
                             <p>Parse a signed integer of a given endianness from a byte buffer.</p>

                        </td>
                    </tr>
                </table><h2 id='types' class='section-header'><a href="#types">Type Definitions</a></h2>
<table>
                    <tr class=' module-item'>
                        <td><a class='type' href='type.Dissector.html'
                               title='rshark::Dissector'>Dissector</a></td>
                        <td class='docblock short'>
                             <p>Type of dissection functions.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='type' href='type.NamedValue.html'
                               title='rshark::NamedValue'>NamedValue</a></td>
                        <td class='docblock short'>
                             <p>A named value-or-error.</p>

                        </td>
                    </tr>
                
                    <tr class=' module-item'>
                        <td><a class='type' href='type.Result.html'
                               title='rshark::Result'>Result</a></td>
                        <td class='docblock short'>
                             <p>The result of a dissection function.</p>

                        </td>
                    </tr>
                </table></section>
    <section id='search' class="content hidden"></section>

    <section class="footer"></section>

    <div id="help" class="hidden">
        <div>
            <div class="shortcuts">
                <h1>Keyboard Shortcuts</h1>

                <dl>
                    <dt>?</dt>
                    <dd>Show this help dialog</dd>
                    <dt>S</dt>
                    <dd>Focus the search field</dd>
                    <dt>&larrb;</dt>
                    <dd>Move up in search results</dd>
                    <dt>&rarrb;</dt>
                    <dd>Move down in search results</dd>
                    <dt>&#9166;</dt>
                    <dd>Go to active search result</dd>
                </dl>
            </div>

            <div class="infos">
                <h1>Search Tricks</h1>

                <p>
                    Prefix searches with a type followed by a colon (e.g.
                    <code>fn:</code>) to restrict the search to a given type.
                </p>

                <p>
                    Accepted types are: <code>fn</code>, <code>mod</code>,
                    <code>struct</code>, <code>enum</code>,
                    <code>trait</code>, <code>typedef</code> (or
                    <code>tdef</code>).
                </p>

                <p>
                    Search functions by type signature (e.g.
                    <code>vec -> usize</code>)
                </p>
            </div>
        </div>
    </div>

    

    <script>
        window.rootPath = "../";
        window.currentCrate = "rshark";
        window.playgroundUrl = "";
    </script>
    <script src="../jquery.js"></script>
    <script src="../main.js"></script>
    
    <script async src="../search-index.js"></script>
</body>
</html>